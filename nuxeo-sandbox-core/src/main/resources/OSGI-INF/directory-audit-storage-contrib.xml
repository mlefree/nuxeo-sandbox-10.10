<?xml version="1.0"?>
<component name="com.mlefree.nuxeo.sandbox.audit.storage.directory">

    <require>org.nuxeo.ecm.platform.audit.service.NXAuditEventsService
    </require>


    <!--
    <extension target="org.nuxeo.ecm.platform.audit.service.NXAuditEventsService"
               point="backend">
        <backend class="com.mlefree.nuxeo.sandbox.audit.storage.impl.DirectoryAuditStorage">
        </backend>
    </extension>-->

    <extension target="org.nuxeo.ecm.platform.audit.service.NXAuditEventsService"
               point="storage">
        <storage id="MLEDirectoryAuditStorage"
                 class="com.mlefree.nuxeo.sandbox.audit.storage.impl.DirectoryAuditStorage"/>
    </extension>

    <extension point="schema" target="org.nuxeo.ecm.core.schema.TypeService">
        <schema name="audit" src="schemas/audit.xsd"/>
    </extension>

    <extension target="org.nuxeo.ecm.directory.GenericDirectory"
               point="directories">
        <directory name="mleAuditStorage" extends="template-directory">
            <schema>audit</schema>
            <idField>id</idField>
            <autoincrementIdField>true</autoincrementIdField>
            <substringMatchType>subany</substringMatchType>
        </directory>
    </extension>
</component>
